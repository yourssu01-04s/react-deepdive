<details>
<summary>ëª©ì°¨</summary>

- [16 - 17 ë³€ê²½ ì‚¬í•­ ìš”ì•½](#16---17-ë³€ê²½-ì‚¬í•­-ìš”ì•½)
  - [ì´ë²¤íŠ¸ ìœ„ì„](#ì´ë²¤íŠ¸-ìœ„ì„)
  - [ì´ë²¤íŠ¸ í’€ë§ ì œê±°](#ì´ë²¤íŠ¸-í’€ë§-ì œê±°)
  - [ìƒˆë¡œìš´ JSX transform](#ìƒˆë¡œìš´-jsx-transform)
  - [useEffectì˜ cleanup í•¨ìˆ˜ê°€ ë¹„ë™ê¸°ë¡œ ë³€ê²½](#useeffectì˜-cleanup-í•¨ìˆ˜ê°€-ë¹„ë™ê¸°ë¡œ-ë³€ê²½)
  - [undefined ì²˜ë¦¬](#undefined-ì²˜ë¦¬)
- [17 - 18 ë³€ê²½ ì‚¬í•­ ìš”ì•½](#17---18-ë³€ê²½-ì‚¬í•­-ìš”ì•½)
  - [ìƒˆë¡œ ì¶”ê°€ëœ í›…](#ìƒˆë¡œ-ì¶”ê°€ëœ-í›…)
    - [useId](#useid)
    - [useTransition](#usetransition)
    - [useDeferredValue](#usedeferredvalue)
    - [useSyncExternalStore](#usesyncexternalstore)
    - [useInsertionEffect](#useinsertioneffect)
  - [react-dom/client](#react-domclient)
    - [createRoot](#createroot)
    - [automatic batching?](#automatic-batching)
    - [hydrateRootê³¼ react-dom/server](#hydraterootê³¼-react-domserver)
    - [strict mode](#strict-mode)
    - [Suspense](#suspense)
    - [IE ì§€ì› ì¤‘ë‹¨](#ie-ì§€ì›-ì¤‘ë‹¨)
- [18 - 19 ë³€ê²½ ì‚¬í•­ ë¹ ë¥´ê²Œ ìš”ì•½](#18---19-ë³€ê²½-ì‚¬í•­-ë¹ ë¥´ê²Œ-ìš”ì•½)
  - [React 19 Compiler](#react-19-compiler)
    - [Ref](#ref)
    - [Form Action](#form-action)
    - [useActionState](#useactionstate)
    - [useOptimistic](#useoptimistic)
    - [useFormStatus](#useformstatus)
    - [use](#use)
  - [React Server Components](#react-server-components)
    - [Server Actions](#server-actions)
    - [waterfall issue?](#waterfall-issue)
- [React 20](#react-20)
  - [ì°¸ê³ ìë£Œ](#ì°¸ê³ ìë£Œ)

</details>

# 16 - 17 ë³€ê²½ ì‚¬í•­ ìš”ì•½

semantic versionìœ¼ë¡œ ë°°í¬í•˜ê²Œ ë˜ë©´ ë©”ì´ì € ë²„ì „ì´ ë°”ë€Œì—ˆì„ ë•Œ, ì´ì „ì˜ ë²„ì „ì€ ì œê³µì´ ì¤‘ë‹¨ë¼ ì‚¬ìš©ì´ ì–´ë ¤ì›Œì§„ë‹¤. í•˜ì§€ë§Œ, ë¦¬ì•¡íŠ¸ëŠ” ì ì§„ì ì¸ ì—…ê·¸ë ˆì´ë“œ ì§€ì›ì„ í•˜ê³  ì´ì „ ë²„ì „ê³¼ ìµœì‹  ë²„ì „ì´ í•œ ì½”ë“œ ë² ì´ìŠ¤ì— ì¡´ì¬í•  ìˆ˜ ìˆë‹¤. (í•˜ì§€ë§Œ, ë‘ ê°œì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë£¨íŠ¸ë¥¼ ë§Œë“¤ì–´ ê´€ë¦¬í•˜ëŠ” ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ê°€ ìˆìŒ)

```tsx
import React from "react";
import ReactDOM from "react-dom";

import ThemeContext from "./shared/ThemeContext";

export default function createLegacyRoot(container) {
  return {
    // ë Œë”ë§
    render(Component, props, context) {
      ReactDOM.render(
        <ThemeContext.Provider value={context.theme}>
          <Component {...props} />
        </ThemeContext.Provider>,
        container
      );
    },
    // ì´ ì»´í¬ë„ŒíŠ¸ì˜ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ì œê±°ë  ë•Œ í˜¸ì¶œë  unmount
    unmount() {
      ReactDOM.unmountComponentAtNode(container);
    },
  };
}

import React, { useContext, useMemo, useRef, useLayoutEffect } from "react";

import ThemeContext from "./shared/ThemeContext";

const rendererModule = {
  status: "pending",
  promise: null,
  result: null,
};

export default function lazyLegacyRoot(getLegacyComponent) {
  const componentModule = {
    status: "pending",
    promise: null,
    result: null,
  };

  return function Wrapper(props) {
    // legacy/createLegacyRoot ë¥¼ promise ë¡œ layzy í•˜ê²Œ ë¶ˆëŸ¬ì˜¨ë‹¤.
    const createLegacyRoot = readModule(
      rendererModule,
      () => import("../legacy/createLegacyRoot")
    ).default;

    const Component = readModule(componentModule, getLegacyComponent).default;
    // êµ¬ ë¦¬ì•¡íŠ¸ë¥¼ ë Œë”ë§í•  ìœ„ì¹˜
    const containerRef = useRef(null);
    // êµ¬ ë¦¬ì•¡íŠ¸ì˜ ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸
    const rootRef = useRef(null);

    const theme = useContext(ThemeContext);
    const context = useMemo(
      () => ({
        theme,
      }),
      [theme]
    );
    useLayoutEffect(() => {
      // ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ì—†ë‹¤ë©´
      if (!rootRef.current) {
        // ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“ ë‹¤.
        rootRef.current = createLegacyRoot(containerRef.current);
      }
      const root = rootRef.current;

      // cleanUp ì‹œì— unmount
      return () => {
        root.unmount();
      };
    }, [createLegacyRoot]);

    useLayoutEffect(() => {
      if (rootRef.current) {
        // ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ì¡´ì¬í•˜ë©´ ì ì ˆí•œ propsì™€ contextë¡œ ë Œë”ë§í•œë‹¤.
        rootRef.current.render(Component, props, context);
      }
    }, [Component, props, context]);

    return <div style={{ display: "contents" }} ref={containerRef} />;
  };
}

function readModule(record, importStatement) {
  // promiseê°€ ì—†ìœ¼ë©´ ì•„ì§ import í•˜ì§€ ëª»í•œ ê²ƒì´ë¯€ë¡œ import ë¥¼ ì‹¤í–‰í•œë‹¤.
  if (!record.promise) {
    /* eslint-disable */
    record.promise = importStatement().then(
      (value) => {
        if (record.status === "pending") {
          record.status = "fulfilled";
          record.promise = null;
          // ì„±ê³µì‹œ import ë°˜í™˜ ê°’
          record.result = value;
          return value;
        }
      },
      (error) => {
        if (record.status === "pending") {
          record.status = "rejected";
          record.promise = null;
          // ì‹¤íŒ¨ì‹œ ì—ëŸ¬
          record.result = error;
        }
      }
    );
  }

  // ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ì‹œì— ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.
  if (record.status === "fulfilled" || record.status === "rejected") {
    return record.result;
  }

  throw record.promise;
}

// AboutPage
import React, { useContext } from "react";

import Clock from "./shared/Clock";
import ThemeContext from "./shared/ThemeContext";
import lazyLegacyRoot from "./lazyLegacyRoot";

const Greeting = lazyLegacyRoot(() => import("../legacy/Greeting"));

export default function AboutPage() {
  const theme = useContext(ThemeContext);
  return (
    <>
      <h2>src/modern/AboutPage.js</h2>
      <h3 style={{ color: theme }}>
        This component is rendered by the outer React ({React.version}).
      </h3>
      <Clock />
      <Greeting />
      <br />
    </>
  );
}
```

ìœ„ì™€ ê°™ì´ í•œ ê°œì˜ ì½”ë“œ ë² ì´ìŠ¤ì— ì—¬ëŸ¬ ë²„ì „ì˜ ë¦¬ì•¡íŠ¸ ì•± íŠ¸ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ(Context ê°™ì€ ê²ƒë„ ì¶©ë¶„íˆ ì§€ì›ì´ ê°€ëŠ¥í•¨), ì¶”ì²œí•˜ëŠ” ë°©ì‹ì€ ì•„ë‹ˆë¼ê³  í•¨.

> ì´ ì ‘ê·¼ ë°©ì‹ì€ ì–´ë””ê¹Œì§€ë‚˜ ì¼ë°˜ì ì¸ ì ‘ê·¼ ë°©ì‹ì´ ì•„ë‹Œ ì„ì‹œë°©í¸ì´ë¼ëŠ” ê²ƒì„ ì•Œì•„ë‘ì–´ì•¼ í•œë‹¤. ëŒ€ë¶€ë¶„ ê°€ëŠ¥í•œ í•˜ë‚˜ì˜ ë¦¬ì•¡íŠ¸ ë²„ì „ì„ ì“°ëŠ” ê²ƒì´ ì¢‹ë‹¤.

---

### ì´ë²¤íŠ¸ ìœ„ì„

ë¦¬ì•¡íŠ¸ 17ë¶€í„°ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ DOMì— í• ë‹¹í–ˆì„ ë•Œì˜ ë™ì‘ì´ ë‹¤ë¥´ë‹¤.

16ë²„ì „ê¹Œì§€ëŠ” ì´ë²¤íŠ¸ê°€ `document`ì— ë¶€ì°©ì´ ë¼ì„œ ë¦¬ì•¡íŠ¸ê°€ í•´ë‹¹ ì´ë²¤íŠ¸ë¥¼ `document`ì—ì„œ ìº¡ì²˜í•œ í›„, ì´ë²¤íŠ¸ê°€ ì‹¤ì œë¡œ ë°œìƒí•œ DOM ìš”ì†Œì— ë§¤í•‘í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™

17ë²„ì „ ë¶€í„°ëŠ” `root`ì— ë¶€ì°©ì´ ë¼ì„œ, documentë¥¼ ë”ëŸ½íˆì§€ ì•Šê³  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. (ê¸°ì¡´ì—ëŠ” documentì— í• ë‹¹ì´ ë˜ê¸° ë•Œë¬¸ì— documentë¡œë¶€í„° ì „íŒŒë˜ëŠ” ì´ë²¤íŠ¸ë“¤ì„ ì²˜ë¦¬í•˜ê¸° ì–´ë ¤ìš´ ë¬¸ì œë“¤ì´ ìˆì—ˆìŒ)

```mermaid
graph TD
    A[Root Node React Root Container] --> B[ëª¨ë“  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë¶€ì°©]
    B --> C[ì´ë²¤íŠ¸ ë°œìƒ ê°ì§€]
    C --> D[dispatchEvent í•¨ìˆ˜ í˜¸ì¶œ]
    D --> E[ì´ë²¤íŠ¸ ê°ì²´ì—ì„œ event.target ì‹ë³„]
    E --> F[Fiber Node í™•ì¸ internalInstanceKey]
    F --> G[Fiber Tree ìˆœíšŒ ì‹œì‘ root nodeê¹Œì§€]
    G --> H[ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì‹ìœ¼ë¡œ Fiber Node íƒìƒ‰]
    H --> I[DispatchQueueì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€]
    I --> J{root Nodeì— ë„ì°©?}
    J -- ì˜ˆ --> K[DispatchQueue ìˆœíšŒ ì‹œì‘]
    K --> L[ì´ë²¤íŠ¸ì™€ ë¦¬ìŠ¤ë„ˆ, ìº¡ì²˜ë§ ì—¬ë¶€ ì¶”ì¶œ]
    L --> M[processDispatchQueueItemsInOrder í•¨ìˆ˜ ì‹¤í–‰]
    M --> N[ì´ë²¤íŠ¸ ì‹¤í–‰ executeDispatch í•¨ìˆ˜ í˜¸ì¶œ]
    J -- ì•„ë‹ˆì˜¤ --> G

```

ìš”ì•½í•˜ë©´, ë²„ë¸”ë§ ë°©ì‹ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ rootì—ì„œ ì²˜ë¦¬í•¨. â†’ rootì—ì„œ ê´€ë¦¬í•¨ìœ¼ë¡œì¨ ê°ê°ì˜ elementì—ì„œ ê´€ë¦¬í•  í•„ìš”ê°€ ì¤„ìŒ(ë©”ëª¨ë¦¬ í–¥ìƒ, í• ë‹¹ ê°ì†Œ)

### ì´ë²¤íŠ¸ í’€ë§ ì œê±°

`Synthetic Event`ëŠ” ë¦¬ì•¡íŠ¸ê°€ ë¸Œë¼ìš°ì € ë”ì„ ê°€ìƒ ë”ìœ¼ë¡œ ì¶”ìƒí™”í•œ ê²ƒ ì²˜ëŸ¼, ì´ë²¤íŠ¸ë„ ê¸°ë³¸ DOMì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì¶”ìƒí™”í•œ ê°ì²´ë¥¼ **Synthetic Event**ë¼ê³  í•¨. í•˜ì§€ë§Œ, ë˜í•‘í•œ ê²ƒì´ë¼ ê²°êµ­ ë¸Œë¼ìš°ì € ì´ë²¤íŠ¸ ë©”ì„œë“œ(preventDefault ë“±)ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.

ë‹¤ë¥¸ ì ìœ¼ë¡œëŠ” ì´ë²¤íŠ¸ í’€ë§ì´ ì¡´ì¬í•˜ëŠ”ë°, ì´ë²¤íŠ¸ê°€ ìƒì„±ë  ë•Œë§ˆë‹¤ `Synthetic Event`ë¡œ ë§Œë“œëŠ” ê²ƒì´ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ì´ë¯€ë¡œ, ì´ë²¤íŠ¸ í’€ì— ì €ì¥í•´ë†¨ë‹¤ê°€ í•„ìš”í•  ë•Œ ì´ë²¤íŠ¸ í’€ì—ì„œ êº¼ë‚´ì„œ ì‚¬ìš©í•˜ê²Œ í•´ ë©”ëª¨ë¦¬ í• ë‹¹ì„ ì¤„ì„. (ê·¼ë° nullë¡œ ì´ˆê¸°í™”í•´ì„œ ë„£ì–´ë‘ë¯€ë¡œ, ë¹„ë™ê¸° ì‘ì—…ì„ í•  ë•Œ ì‘ë‹µì´ ì˜¨ ì‹œì ì—” ì´ë¯¸ nullë¡œ ì´ˆê¸°í™”ë¼ ì´ë²¤íŠ¸ í’€ë¡œ ë“¤ì–´ê°€ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŒ)

17ë²„ì „ë¶€í„°ëŠ” ì´ë²¤íŠ¸ í’€ë§ì„ ì—†ì• ê³  ê·¸ëƒ¥ ì´ë²¤íŠ¸ë§ˆë‹¤ **Synthetic Event**ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ê³  ë’· ì²˜ë¦¬ëŠ” ê°€ë¹„ì§€ ì»¬ë ‰í„°ì—ê²Œ ë§¡ê¹€.

https://gist.github.com/romain-trotard/76313af8170809970daa7ff9d87b0dd5

### ìƒˆë¡œìš´ JSX transform

```tsx
// êµ¬ë²„ì „
// before transpile
const Component = () => <div>hello World</div>;

// after transpile
// ERROR! createElement ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•œ Reactê°€ ì—†ìŒ. (ê·¸ë˜ì„œ ê¸°ì¡´ì—” import React from 'react'ê°€ í•„ìš”í–ˆìŒ.)
var Component = React.createElement("div", null, "hello world");

// ì‹ ë²„ì „
// after transpile
var _jsxRuntime = require("react/jsx-runtime");
var Component = (0, _jsxRuntime.jsx)("div", {
  children: (0, _jsxRuntime.jsx)("hello world", {}),
});
```

ìœ„ì™€ ê°™ì´ `íŠ¸ëœìŠ¤íŒŒì¼`ì‹œ ìë™ìœ¼ë¡œ ì¶”ê°€ë˜ëŠ” ê²ƒìœ¼ë¡œ ë³€ê²½ë¼ ë¶ˆí•„ìš”í•œ ì½”ë“œë¥¼ ì“°ì§€ ì•Šì•„ë„ ë¨.

### useEffectì˜ cleanup í•¨ìˆ˜ê°€ ë¹„ë™ê¸°ë¡œ ë³€ê²½

16ë²„ì „ì—ì„œëŠ” cleanupì´ ë™ê¸°ì ì´ë¼ ë‹¤ìŒ ë Œë”ë§ê¹Œì§€ ì˜í–¥ì„ ì£¼ì—ˆìŒ.

17ë²„ì „ì—ì„œëŠ” ì»¤ë°‹ ë‹¨ê³„ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ì§€ì—°í•˜ê³  ì‹¤í–‰í•¨.

### undefined ì²˜ë¦¬

16, 17ì—ì„œëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ undefinedë¥¼ ë°˜í™˜í•˜ëŠ”ê²Œ ì—ëŸ¬ë¼ê³  íŒë‹¨í•˜ê³  ì—ëŸ¬ë¡œ ì²˜ë¦¬í•˜ì˜€ìŒ.

í•˜ì§€ë§Œ, 18ë²„ì „ì—ì„œëŠ” ì—ëŸ¬ê°€ ì•„ë‹ˆê²Œ ë°”ë€Œì—ˆë‹¤.

# 17 - 18 ë³€ê²½ ì‚¬í•­ ìš”ì•½

## ìƒˆë¡œ ì¶”ê°€ëœ í›…

### useId

ë¦¬ì•¡íŠ¸ì—ì„œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ìœ ë‹ˆí¬í•œ ê°’ì„ ê°–ê²Œ í•˜ëŠ” ê²ƒì´ë‚˜ ì„œë²„ì‚¬ì´ë“œë Œë”ë§ì—ì„œë„ ë Œë”ë§ ê²°ê³¼ê°€ ì¼ì¹˜í•˜ê¸°ëŠ” ì‰½ì§€ ì•Šì€ ì¼ì´ë¼, ë¦¬ì•¡íŠ¸ ì¸¡ì—ì„œ ì œê³µí•˜ëŠ” ëœë¤í•œ 32ê¸€ì ì´ì§„ ë¬¸ìì—´ì„ ë°˜í™˜í•˜ëŠ” í›…

### useTransition

UI ë³€ê²½ì„ ê°€ë¡œë§‰ì§€ ì•Šê³  ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ” í›…

```tsx
import React, { useState, useTransition } from 'react';

function App() {
  const [activeTab, setActiveTab] = useState('tab1');
  const [list, setList] = useState([]);
  const [isPending, startTransition] = useTransition();

  const handleTabClick = (tab) => {
    setActiveTab(tab);

    if (tab === 'tab2') {
      startTransition(() => {
        // ë¬´ê±°ìš´ ì—°ì‚°: ëŒ€ê·œëª¨ ë¦¬ìŠ¤íŠ¸ ìƒì„± (ì˜ˆ: ë§Œë§Œê°œ ì•„ì´í…œ)
        const newList = Array(10000ë§Œê°œ)
          .fill(0)
          .map((_, index) => `Item ${index + 1}`);
        setList(newList);
      });
    }
  };

  return (
    <div>
      <div style={{ marginBottom: '20px' }}>
        <button onClick={() => handleTabClick('tab1')}>Tab 1</button>
        <button onClick={() => handleTabClick('tab2')}>Tab 2</button>
      </div>

      <div>
        {activeTab === 'tab1' && <p>This is Tab 1 content.</p>}
        {activeTab === 'tab2' && (
          <>
            {isPending ? <p>Loading heavy content...</p> : <ul>{list.map((item) => <li key={item}>{item}</li>)}</ul>}
          </>
        )}
      </div>
    </div>
  );
}

export default App;

```

- **ì‚¬ìš©ìê°€ íƒ­ì„ í´ë¦­**í•˜ë©´, íƒ­ ì „í™˜ì€ **ì¦‰ì‹œ ì²˜ë¦¬**ë©ë‹ˆë‹¤. íƒ­ ì „í™˜ ìì²´ëŠ” ê³ ìš°ì„ ìˆœìœ„ ì‘ì—…ì´ê¸° ë•Œë¬¸ì—, UIê°€ ì¦‰ì‹œ ë°˜ì‘í•˜ê²Œ ë©ë‹ˆë‹¤.
- **íƒ­ ì „í™˜ í›„ ë¬´ê±°ìš´ ì‘ì—…**(ì˜ˆ: í° ë°ì´í„°ë¥¼ ë Œë”ë§í•˜ëŠ” ì‘ì—…)ì€ **`startTransition`** ì•ˆì—ì„œ ì €ìš°ì„ ìˆœìœ„ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤. ì´ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ UIëŠ” ì¦‰ê°ì ì¸ ë°˜ì‘ì„ ë³´ì—¬ì£¼ê³ , ë¬´ê±°ìš´ ì‘ì—…ì´ ëë‚œ í›„ì— ìƒíƒœê°€ ë³€ê²½ë©ë‹ˆë‹¤.

ì´í•´í•˜ê¸° ì‰½ê²Œ ì„¤ëª…í•˜ë©´, UI ë°˜ì˜ì„ ë¨¼ì €í•˜ê³  ìƒíƒœì²˜ë¦¬ë¥¼ í•œë‹¤ê³  ìƒê°í•˜ë©´ ë¨.

### useDeferredValue

ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì—ì„œ ë¦¬ë Œë”ë§ì´ ê¸‰í•˜ì§€ ì•Šì€ ë¶€ë¶„ì„ ì§€ì—°í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” í›…

1. ë””ë°”ìš´ìŠ¤
   **íŠ¹ì • ì´ë²¤íŠ¸ê°€ ì—°ì†ì ìœ¼ë¡œ ë°œìƒí•  ë•Œ, ë§ˆì§€ë§‰ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê³  ì¼ì • ì‹œê°„ ë™ì•ˆ ì¶”ê°€ ì´ë²¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì‹¤í–‰**ë˜ëŠ” ë°©ì‹
2. ì“°ë¡œí‹€
   **íŠ¹ì • ì´ë²¤íŠ¸ê°€ ê³„ì† ë°œìƒí•˜ë”ë¼ë„, ì¼ì • ì‹œê°„ ë‚´ì—ëŠ” í•œ ë²ˆë§Œ ì‹¤í–‰**ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì£¼ê¸°ì ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ ì œí•œí•˜ì—¬ ì¼ì • ê°„ê²©ìœ¼ë¡œë§Œ ì‹¤í–‰í•˜ëŠ” ë°©ì‹

```tsx
import React, { useState, useDeferredValue, useMemo } from 'react';

function FilterComponent() {
  const [input, setInput] = useState('');
  const deferredInput = useDeferredValue(input);  // ì…ë ¥ê°’ ì§€ì—° ì²˜ë¦¬

  const filteredList = useMemo(() => {
    return Array(10000ë§Œê°œ)
      .fill(0)
      .map((_, index) => `Item ${index + 1}`)
      .filter((item) => item.includes(deferredInput));  // ì§€ì—°ëœ ì…ë ¥ê°’ ì‚¬ìš©
  }, [deferredInput]);

  return (
    <div>
      <input
        value={input}
        onChange={(e) => setInput(e.target.value)}
        placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
      />
      <ul>
        {filteredList.map((item) => (
          <li key={item}>{item}</li>
        ))}
      </ul>
    </div>
  );
}

export default FilterComponent;
```

ë§ˆì°¬ê°€ì§€ë¡œ, UI ë°˜ì˜ì€ ê·¸ëŒ€ë¡œ ë˜ê³ , ë¬´ê±°ìš´ ì‘ì—…ì€ ë‚˜ì¤‘ìœ¼ë¡œ ë¯¸ë£¸.

> useTransition vs useDeferredValue?
> ì§€ì—°ì„ ì–¸ì œí•˜ëŠëƒê°€ ì¤‘ìš”í•œ ë¬¸ì  ë°, useDeferredValueëŠ” ì§€ì—°ëœ ê°’ì„ ì‚¬ìš©í•  ë•Œì´ê³  useTransitionì€ ì‘ì—…ì„ ì§€ì—°ì‹œí‚¤ëŠ” ì°¨ì´ê°€ ìˆìŒ.

### useSyncExternalStore

ë°ì´í„°ëŠ” ë¦¬ì•¡íŠ¸ ë‚´ë¶€ì—ë§Œ ì¡´ì¬í•˜ëŠ”ê²Œ ì•„ë‹˜(localStorage, window ê°ì²´, javascript ë³€ìˆ˜ ë“±)

í•˜ì§€ë§Œ, **ìƒíƒœ**ê°€ ì•„ë‹ˆë¯€ë¡œ ë¦¬ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ì§€ ì•ŠìŒ. â†’ ê·¸ëŸ¬ë©´ ìƒíƒœë‘ ì—°ê²°í•´ì„œ(êµ¬ë…í•´ì„œ) í•´ê²°!

```tsx
import React, { useState, useEffect } from "react";
import { useSyncExternalStore } from "react";

function subscribe(callback) {
  // ì°½ í¬ê¸° ë³€ê²½ ì‹œ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•˜ê³  ì½œë°±ì„ í˜¸ì¶œ
  window.addEventListener("resize", callback);
  return () => window.removeEventListener("resize", callback);
}

function getSnapshot() {
  // í˜„ì¬ ë¸Œë¼ìš°ì € ì°½ í¬ê¸° ë°˜í™˜
  return { width: window.innerWidth, height: window.innerHeight };
}

function getServerSnapshot() {
  // ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ ì‹œ ê³ ì •ëœ í¬ê¸°ë¥¼ ë°˜í™˜ (ì„ íƒ ì‚¬í•­)
  return { width: 1024, height: 768 };
}

function WindowSize() {
  const size = useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot);

  return (
    <div>
      <p>Window width: {size.width}px</p>
      <p>Window height: {size.height}px</p>
    </div>
  );
}

export default WindowSize;
```

### useInsertionEffect

- useEffect
  í™”ë©´ì— ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§ í•œ í›„
- useLayoutEffect
  DOM ë³€ê²½ ì‘ì—…ì´ ë‹¤ ëë‚œ ì´í›„ì— ì‹¤í–‰ (ì‹¤ì œ ë Œë”ë§ ì „)
- useInsertionEffect
  DOM ë³€ê²½ ì‘ì—…ì´ ì‹¤í–‰ë˜ê¸° ì´ì „ì— ì‹¤í–‰ (DOMì— ì‚½ì…í•˜ê¸° ì „)

## react-dom/client

### createRoot

ë™ì‹œì„± ëª¨ë“œë¥¼ í™œì„±í™”í•˜ëŠ” ìƒˆë¡œìš´ DOM API â†’ automatic batchingì´ ì ìš©ë¨

<aside>
ğŸ’¡

### automatic batching?

ì—¬ëŸ¬ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ í•˜ë‚˜ì˜ ë Œë”ë§ ì‘ì—…ìœ¼ë¡œ ë¬¶ì–´ì„œ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹

```tsx
// ë¦¬ì•¡íŠ¸ 18ì˜ ë™ì‘: ë™ê¸°ì  ìƒíƒœ ì—…ë°ì´íŠ¸
function handleClick() {
  setCount((c) => c + 1); // ì²« ë²ˆì§¸ ìƒíƒœ ì—…ë°ì´íŠ¸
  setToggle((t) => !t); // ë‘ ë²ˆì§¸ ìƒíƒœ ì—…ë°ì´íŠ¸
  // ë‘ ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” ìë™ìœ¼ë¡œ ë°°ì¹˜ ì²˜ë¦¬ë¨ -> ë Œë”ë§ 1ë²ˆë§Œ ë°œìƒ
}
```

</aside>

### hydrateRootê³¼ react-dom/server

- renderToPipeableStream
  HTMLì„ ì ì§„ì ìœ¼ë¡œ ë Œë”ë§, Suspenseë‘ ì‚¬ìš©í•˜ë©´ í™˜ìƒì˜ ê¶í•©
- renderToReadableStream
  ì›¹ ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•´ì„œ ë Œë”ë§í•˜ê²Œ í•¨. ì €ìê°€ ì •ë§ ì“¸ ì¼ì´ ì—†ë‹¤ê³  í•¨.

### strict mode

- classí˜• ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì— ì œì•½ì„ ë§ì´ ì¶”ê°€í•´ì„œ, ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ê°€ì´ë“œ í•´ì¤Œ.
- êµ¬ React APIë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë„ ì œì•½ì„ ì¶”ê°€í•´ ìì œí•˜ë„ë¡ í•¨.
- useEffectë¡œ ì¸í•œ race condition ê²€ì‚¬ ë“± side effect ì ê²€

### Suspense

18 ì´ì „ì˜ SuspenseëŠ” fallbackë³´ë‹¤ ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ useEffectê°€ ë¨¼ì € ì‹¤í–‰ë˜ê±°ë‚˜ ì„œë²„ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ì—ˆë˜ ë¬¸ì œê°€ ìˆì—ˆì§€ë§Œ í˜„ì¬ëŠ” í•´ê²°ë¨.

### IE ì§€ì› ì¤‘ë‹¨

ë¦¬ì•¡íŠ¸ ë‚´ë¶€ ì½”ë“œì—ì„œë„ promise, symbol, Object.assignì„ ì‚¬ìš©í•˜ë©´ì„œ ì´ì œ í•´ë‹¹ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ë¥¼ ìœ„í•´ì„œëŠ” í´ë¦¬í•„í•´ì•¼ í•¨.

# 18 - 19 ë³€ê²½ ì‚¬í•­ ë¹ ë¥´ê²Œ ìš”ì•½

https://react.dev/blog/2024/04/25/react-19

ë¦¬ì•¡íŠ¸ 18ë²„ì „ ë¦´ë¦¬ì¦ˆê°€ 2022ë…„ 3ì›”ì— ëëŠ”ë°, ì•½ 2ë…„ ë°˜ë§Œì˜ ì—…ë°ì´íŠ¸.

## React 19 Compiler

ì´ì „ì— 3ì¥ì—ì„œ react-hookì„ ê³µë¶€í•˜ë©´ì„œ ë©”ëª¨ì´ì œì´ì…˜ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ì— ëŒ€í•´ì„œ ê³ ë¯¼í–ˆì—ˆëŠ”ë°, ë¦¬ì•¡íŠ¸ 19ê°€ ë˜ë©´ì„œ ëª¨ë“  ê²ƒì´ ë©”ëª¨ì´ì œì´ì…˜ë˜ê²Œ ëìŒ. (í•¨ìˆ˜, ì»´í¬ë„ŒíŠ¸ ë“±)

ì´ì „ì˜ ë°°ë“œ íŒ¨í„´ë“¤ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•´ë„, ëª¨ë‘ ë©”ëª¨ì´ì œì´ì…˜ ëê¸° ë•Œë¬¸ì— ë Œë”ë§ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šê²Œ ë¨.

```tsx
// bad
const Component = () => {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <>
      <Button onClick={() => setIsOpen(true)}>open dialog</Button>
      {isOpen && <ModalDialog />}
      <VerySlowComponent />
    </>
  );
};

// good
const ButtonWithDialog = () => {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <>
      <Button onClick={() => setIsOpen(true)}>open dialog</Button>
      {isOpen && <ModalDialog />}
    </>
  );
};

const Component = () => {
  return (
    <>
      <ButtonWithDialog />
      <VerySlowComponent />
    </>
  );
};

// í•˜ì§€ë§Œ, React Compilerê°€ ë„ì…ë˜ë©´ì„œ ë¬´ì˜ë¯¸ í•´ì§.
```

ì •ë¦¬í•˜ë©´, ë¦¬ì•¡íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹Œë“œí•  ë•Œ í•¨ìˆ˜ë‚˜ ì»´í¬ë„ŒíŠ¸ memo ì‘ì—…ì„ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì´ ìƒê¸´ ê²ƒ.

í•˜ì§€ë§Œ, ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ useMemoë‚˜ useCallbackì„ ì“°ëŠ” ê²ƒì€ ë©”ëª¨ë¦¬ë¥¼ ì“°ëŠ” ì‘ì—…ì„. ê²Œë‹¤ê°€ í´ë¡œì €ë¥¼ ê³ë“¤ì´ê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ í° ë³€ìˆ˜ê°€ ìƒê¸´ë‹¤ë©´ ì¬ìƒì„±ë˜ì§€ ì•Šë„ë¡ ìœ ì˜í•´ì•¼ í•¨.

ë¦¬ì•¡íŠ¸ ì»´íŒŒì¼ëŸ¬ í”Œë ˆì´ê·¸ë¼ìš´ë“œ https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBUYCAyngIZ4IA0JZAwlQDasBGVcA1gQL4EAZjAgYCAHRAwE3PFIDcEgHYq4rKmDAEAQmgDmAeQ4ArBHELAVBAligdWaOARlUAJhGWsAngTc0qAgBeAmUEAHcCAFU0ZTwADgBBGBgqbwAKAEYABgAmABYCACoCHILi0uyASiVlfhUVBAAPHHxhKGULNE8CRKwsdKqiawI4TzBCAG0xjrxEhjI8Jmg4xIBdYMYKalp06tqbMeUJgmmVvB0FhCXznQ2Q0m2aBD2akaOTjgMAEQDNsMieiMpnMeEGCgIAHpIZUALI6AgQIR+AINZSHcaEAAWVGUblYCCYjl4iU2jxY7C4vHSg2CAD5huibARFstZol0jNVgQANSlN5M-gMM7stYC96Ygg4vEEolOHgIh7MNicbg8GlDIIMqxMmys26c268-kHATCrkXMW1EbQggAFSxaG0nh8BGaTrw2jwED8CAwmNStAIeCxCFsogcfolx2xuPxhOJCogIc2tK1jOZUrjssTHIFmel8blvB04JGGOOEAJADpWBB9OkvvpftRq-5WwTlPoQ-mBNamTI8LB0elywQADxuNAANzpY5s444UDw3vRnmLPCCwELOfliX4dIAkp0ZBgEHFeuPIUuV5457rmYvl6vEcoN1udwn5ToD8e4Kfz0IHQrxvVd70zBdQJ6ddEw-bMvxLZMsV-E8-UA3QkJA5873nCcsHAiCbESZAiAtfcGB0EjgAtH9cKvfCxyvKdZxGAV+AUEB+CAA

### Ref

forwardRef ì•ˆì¨ë„ refë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆê²Œ ë¨.

### Form Action

ê¸°ì¡´ì˜ reactì—ì„œëŠ” ë¹„ë™ê¸° ì•¡ì…˜ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ ë¡œë”© ìƒíƒœ, ì—ëŸ¬ ìƒíƒœ, ë‚™ê´€ì  ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬í–ˆì–´ì•¼ í•˜ì§€ë§Œ, 19ë¶€í„°ëŠ” Actionsë¡œ ìë™í™”í•  ìˆ˜ ìˆê²Œ ë¨.

### useActionState

- ì˜›ë‚ ì˜ ëª»ìƒê¸´ ë¬¸ë²•

  ```tsx
  // Using pending state from Actions
  function UpdateName({}) {
    const [name, setName] = useState("");
    const [error, setError] = useState(null);
    const [isPending, startTransition] = useTransition();

    const handleSubmit = () => {
      startTransition(async () => {
        const error = await updateName(name);
        if (error) {
          setError(error);
          return;
        }
        redirect("/path");
      });
    };

    return (
      <div>
        <input value={name} onChange={(event) => setName(event.target.value)} />
        <button onClick={handleSubmit} disabled={isPending}>
          Update
        </button>
        {error && <p>{error}</p>}
      </div>
    );
  }
  ```

19ë²„ì „ë¶€í„°ì¸ ì˜ìƒê¸´ ë¬¸ë²•

```tsx
function ChangeName({ name, setName }) {
  const [error, submitAction, isPending] = useActionState(
    async (previousState, formData) => {
      const error = await updateName(formData.get("name"));
      if (error) {
        return error;
      }
      redirect("/path");
      return null;
    },
    null
  );

  return (
    <form action={submitAction}>
      <input type="text" name="name" />
      <button type="submit" disabled={isPending}>
        Update
      </button>
      {error && <p>{error}</p>}
    </form>
  );
}
```

### useOptimistic

**ë¹„ë™ê¸° ì‘ì—…ì´ ì™„ë£Œë˜ê¸° ì „**ì— ì‚¬ìš©ìì—ê²Œ **ì¦‰ê°ì ì¸ í”¼ë“œë°±**ì„ ì œê³µí•˜ëŠ” UI íŒ¨í„´

```tsx
function ChangeName({ currentName, onUpdateName }) {
  const [optimisticName, setOptimisticName] = useOptimistic(currentName);

  const submitAction = async (formData) => {
    const newName = formData.get("name");
    setOptimisticName(newName); // ë‚™ê´€ì  ì—…ë°ì´íŠ¸
    const updatedName = await updateName(newName); // ì‹¤ì œ API ìš”ì²­
    onUpdateName(updatedName); // ìµœì¢…ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ ê°’ ë°˜ì˜
  };

  return (
    <form action={submitAction}>
      <p>Your name is: {optimisticName}</p>
      <p>
        <label>Change Name:</label>
        <input
          type="text"
          name="name"
          disabled={currentName !== optimisticName}
        />
      </p>
    </form>
  );
}
```

### useFormStatus

react-hook-formì—ì„œì˜ [useFormContext](https://react-hook-form.com/docs/useformcontext)ì„ í›…ìœ¼ë¡œë„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë¨.

```tsx
import { useFormStatus } from "react-dom";

function DesignButton() {
  const { pending } = useFormStatus(); // í¼ì˜ ìƒíƒœë¥¼ í™•ì¸
  return (
    <button type="submit" disabled={pending}>
      Submit
    </button>
  );
}
```

### use

`use`í›…ì€ ë¹„ë™ê¸° ë°ì´í„°ë¥¼ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í›…

```tsx
import { use } from "react";

function Comments({ commentsPromise }) {
  const comments = use(commentsPromise); // Promiseê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
  return comments.map((comment) => <p key={comment.id}>{comment.text}</p>);
}

function Page({ commentsPromise }) {
  return (
    <Suspense fallback={<div>Loading comments...</div>}>
      <Comments commentsPromise={commentsPromise} />
    </Suspense>
  );
}
```

Suspenseë¥¼ ì“°ê¸° ìœ„í•´ì„œëŠ” ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ì—ì„œ promiseë¥¼ throwí–ˆì–´ì•¼ í•˜ëŠ”ë°, ìš”ê²ƒì„ ê°„ë‹¨í•˜ê²Œ í•´ì£¼ëŠ” í›…ì„.

## React Server Components

Next.jsë‚˜ Remixê°™ì€ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë©´ renderToPipeableStreamê³¼ ê°™ì€ APIë¥¼ ì‚¬ìš©í•´ì„œ ì„œë²„ì—ì„œ ë Œë”ë§í•˜ê³  í´ë¼ì´ì–¸íŠ¸ëŠ” ë°›ì•„ì„œ í™”ë©´ì— ê·¸ë¦¬ê¸°ë§Œ í•˜ë„ë¡ ì§€ì›í•˜ì˜€ìŒ.

### Server Actions

**Server Actions**ëŠ” í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ëŠ” **ë¹„ë™ê¸° í•¨ìˆ˜**ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. `use server` ì§€ì‹œì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ ì•¡ì…˜ì„ í˜¸ì¶œí•˜ë©´, ì„œë²„ì—ì„œ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³  ê²°ê³¼ë¥¼ ë°˜í™˜í•¨

- **ì„œë²„ì—ì„œ ë¹„ë™ê¸° ì‘ì—… ì‹¤í–‰** ë° ê²°ê³¼ ë°˜í™˜
- í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‰½ê²Œ ì„œë²„ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì²˜ë¦¬ ê°€ëŠ¥
- ì„œë²„ ì•¡ì…˜ì€ **ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì„œë²„ì—ì„œ ì²˜ë¦¬**í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬í•˜ì—¬ ìƒíƒœ ì—…ë°ì´íŠ¸

ì•„ë˜ì™€ ê°™ì€ ê¸°í–‰ì´ í´ë¼ì´ì–¸íŠ¸ì˜ javascriptë‹¨ì´ ì•„ë‹Œ ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ, ë²ˆë“¤ ì‚¬ì´ì¦ˆ ì¤„ì´ê³  ë³´ì•ˆë„ up

APIë¥¼ ìœ„í•´ JWTë¥¼ ê³ë“¤ì´ê±°ë‚˜ í•˜ëŠ” ê²ƒì„ ëª¨ë‘ ì„œë²„ì—ê²Œ ìœ„ì„ì´ ê°€ëŠ¥í•¨. í´ë¼ì´ì–¸íŠ¸ê°€ ì‹ ê²½ì¨ì•¼ í•˜ëŠ” ê²ƒì€ ì˜¤ë¡œì§€ viewë§Œ ë‚¨ê²Œ ë¨.

```tsx
"use server";

import { sql } from "@vercel/postgres";
import { revalidatePath } from "next/cache";

export type Tweet = {
  id: string;
  tweet: string;
  likes: number;
  created_at: Date;
  sending?: boolean;
};

const delay = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));

type Result =
  | {
      success: true;
    }
  | {
      success: false;
      error: string;
    };

const maxDailyTweets = 10;
let tweetCount = 0;

export async function addTweet(tweet: string): Promise<Result> {
  "use server";
  if (tweetCount > maxDailyTweets) {
    return {
      success: false,
      error: "Exceeds the number of tweets possible per day",
    };
  }

  try {
    await sql`INSERT INTO tweets (tweet, likes) VALUES (${tweet}, ${0})`;
  } catch (error) {
    console.error(error);
    return { success: false, error: "Failed to add tweet" };
  }

  tweetCount++;

  revalidatePath("/");
  return { success: true };
}

export async function likeTweet(id: string) {
  try {
    await sql`UPDATE tweets SET likes = likes + 1 WHERE id = ${id}`;
  } catch (error) {
    console.error(error);
  } finally {
    revalidatePath("/");
  }
}
```

### waterfall issue?

```tsx
export default function App() {
	return (
	  <Suspense fallback={<p>...</p>}>
	    <RepoData name="tanstack/query" /> -> 1
	    <RepoData name="tanstack/table" /> -> 2
	  </Suspense>
	)
}
```

ì›ë˜ëŠ” ìœ„ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í–ˆì„ ë•Œ, ë³‘ë ¬ì ìœ¼ë¡œ APIë¥¼ fetchingí•˜ê³  promiseë¥¼ í™•ì¸í•´ì„œ ë Œë”ë§í–ˆìœ¼ë‚˜ 19ë²„ì „ë¶€í„°ëŠ” ì´ë¥¼ ì§ë ¬ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´.

ë³€ê²½ì˜ ì˜ë„ëŠ”, ì²« ë²ˆì§¸ ì»´í¬ë„ŒíŠ¸ê°€ ë°ì´í„° í˜ì¹­ì„ í•˜ê³  ìˆì„ ë•Œ í˜•ì œ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ë Œë”ë§í•˜ëŠ” ê²ƒì€ ì„±ëŠ¥ ë‚­ë¹„(ë Œë”ë§í•œë‹¤ëŠ” ê²ƒì€ DOMì— í™”ë©´ì„ ê·¸ë¦°ë‹¤ëŠ” ë§ì´ ì•„ë‹ˆë¼ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ ë™ì‘ì„ í•˜ëŠ” ê²ƒë“¤ ë“±)ì´ê¸° ë•Œë¬¸ì— Suspenseì•ˆì—ì„œ ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ê°€ suspendëì„ ë•Œ í˜•ì œ ì»´í¬ë„ŒíŠ¸ì˜ ë Œë”ë§ì„ ì¤‘ë‹¨í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™” í•˜ìëŠ” ê²ƒì´ì—ˆìŒ.

í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” render í˜ì´ì¦ˆë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šìœ¼ë©´ fetchingì´ ì§ë ¬ë¡œ ì‹¤í–‰ë¼ waterfallì„ ë§Œë“¤ì–´ ë” ëŠë¦¬ê²Œ ë™ì‘í•˜ëŠ” ê²°ê³¼ê°€ ë°œìƒ.

ìµœì¢…ì ìœ¼ë¡œëŠ” fetching ì‹œì ì„ ì•ìœ¼ë¡œ ë•¡ê²¨ì„œ ìµœì í™”í•˜ë ¤ëŠ” ì˜ë„ì˜€ìŒ.

```tsx
// fetching ì‹œì ì„ routerì—ê²Œ ìœ„ì„
const router = createBrowserRouter([
  {
    path: "/",
    element: <App />,
    loader: () => {
      // ë°ì´í„° í˜ì¹­ì„ ë¯¸ë¦¬ ì‹œì‘
      queryClient.prefetchQuery("dataA", fetchDataA);
      queryClient.prefetchQuery("dataB", fetchDataB);
    },
  },
]);

// fetching ì‹œì ì„ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ìœ„ì„
function App() {
  const dataAPromise = queryClient.prefetchQuery("dataA", fetchDataA);
  const dataBPromise = queryClient.prefetchQuery("dataB", fetchDataB);

  return (
    <Suspense fallback={<p>Loading...</p>}>
      <ComponentA />
      <ComponentB />
    </Suspense>
  );
}
```

í•˜ì§€ë§Œ, ìƒìœ„ ë ˆë²¨ì— fetchingì„ ìœ„ì„í•˜ê³  ìì‹ì´ ë°›ì•„ì„œ ë Œë”ë§í•˜ëŠ” ê²ƒì€ ReactìŠ¤ëŸ½ì§€ ì•ŠìŒ.

ëª¨ë“  ìƒí™©ì— ì ìš©ì´ ì–´ë ¤ìš¸ ë¿ë”ëŸ¬ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ í•„ìš”í•œ ë°ì´í„° í˜ì¹­ì„ ìˆ˜í–‰í•˜ì—¬, ì»´í¬ë„ŒíŠ¸ê°€ ìì‹ ì˜ ë°ì´í„° ì˜ì¡´ì„±ì„ ëª…í™•í•˜ê²Œ í‘œí˜„ì´ ì–´ë ¤ì›Œì§. â†’ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•„ìš”ì—†ëŠ” ë°ì´í„°ë“¤ì„ ë¯¸ë¦¬ ë•¡ê²¨ì™€ì•¼ í•¨.

https://github.com/facebook/react/pull/26380

https://tkdodo.eu/blog/react-19-and-suspense-a-drama-in-3-acts

https://medium.com/yourssu/tanstack-query-ì‚¬ìš©-ì¤‘-ë°œìƒí•˜ëŠ”-request-waterfall-í•´ê²°í•˜ê¸°-09a20db6659d

# React 20

https://www.youtube.com/watch?v=tQfuf27xUXQ

### ì°¸ê³ ìë£Œ

https://www.intelligencelabs.tech/062b17fe-7b82-4bae-ba7f-0c17baca1bab
